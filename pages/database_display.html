<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/styles/admincontent.css">
    <link rel="stylesheet" href="/styles/components.css">
    <link rel="stylesheet" href="/styles/database.css">
    <link rel="stylesheet" href="/styles/databasepopup.css">
    <title>SecureHold</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    <link rel="icon" href="/resources/images/logo.png" type="image/png">
    <script src="/components/sidebar.js" type="text/javascript" defer></script>
    <script src="/components/header.js" type="text/javascript" defer></script>
    <script src="/components/popupModal.js" type="text/javascript" defer></script>
    <script src="/components/snackbarNotification.js" type="text/javascript" defer></script>
    <script src="/components/datatables.js" type="text/javascript" defer></script>

</head>

<body style="display: flex; overflow: hidden;" >
    <sidebar-component></sidebar-component>

    <div class="content-container">
        <header-component headerTitle="database_name_display_here" ></header-component>
        
        <div class="body">
            <div class="content-split-left" style="width: 100%">

                <div class="content">
                    <div class="top-container">
                        <div class="add-user-btn-container">
                            <div class="pls-move-btn">
                                <input type="button" class="add-user-btn" value="Add User">
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <datatable-component></datatable-component>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <popupmodal-component modalId="edit-user-db" modalClass="jessica-container">
        <div class="ann-delete-text1">
            <strong>Edit User</strong>
        </div>
        <div class="edit-user-content-container" style="margin-top: 10px;">
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="userid">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="Then Wen Wen">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="RFID ID">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="5">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="IC HERE">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-same" placeholder="PHONE 01092702131">
            </div>
            <div class="user-id-textfield">
                <input type="text" class="form-input-diff" placeholder="username:stupidlolfuck" readonly>
            </div>
        </div>
        <div class="pop-container">
            <div class="announcement-cancel-pop" onclick="showPopup('edit-user-db', false)">
                <div class="ann-cancel-text">
                    Cancel
                </div>
            </div>
            <div class="announcement-confirm-pop">
                <div class="ann-delete-text">
                    Update
                </div>
            </div>
        </div>
    </popupmodal-component>

    <popupmodal-component modalId="delete-user-db" modalClass="dylan-container">
        <div class="ann-delete-text1">
            <strong>Delete User</strong>
        </div>
        <div class="ann-delete-text1" style="margin-top: 10px;">
            Are you sure to delete this user?
        </div>
        <div class="pop-container">
            <div class="announcement-cancel-pop" onclick="showPopup('delete-user-db', false)">
                <div class="ann-cancel-text">
                    Cancel
                </div>
            </div>
            <div class="announcement-confirm-pop">
                <div class="ann-delete-text">
                    Delete
                </div>
            </div>
        </div>
    </popupmodal-component>

</div>
</body>
</html>

<!--import datatables shit here-->
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.bootstrap5.css">
<script src="https://cdn.datatables.net/2.0.0/js/dataTables.bootstrap5.js"></script>
<script src="https://cdn.datatables.net/v/bs5/jq-3.7.0/dt-2.0.0/datatables.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
<script src="/app.js"></script>

<script>
    checkSession()

    const params = new URLSearchParams(location.search);
    const db = params.get("db");

    switch(db) {
        case "users": 
            document.querySelector('header-component').setAttribute('headerTitle', "Users database");
            getUserData().then((resp) => { 
                console.log(resp.data.userData)
                const headers = {
                    "User ID": "web_data.user_id",
                    "Name": "name",
                    "Locker ID": "locker_id",
                    "DOB": "dob",
                    "NRIC / Passport": "nric_passport",
                    "Phone No": "phone"
                }
                setDatatableOptions(resp.data.userData, headers)
            }); 
            break;
    }
    
    async function getUserData() {
        try {
            const userData = await axios.get(apiLink + "users/users/getAllusers")
            return userData; 
        } catch (e) {
            console.log(e);
            return null;
        }
    }
</script>